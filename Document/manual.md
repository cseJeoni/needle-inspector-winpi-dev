# Needle Inspector 사용자 매뉴얼 (v1.0)

**발행일**: 2025-10-17
**회사**: SOLIS MSN

---

## 목차

1.  **서문**
    *   1.1. 매뉴얼에 대하여
    *   1.2. 제품 개요
    *   1.3. 주요 기능 요약
    *   1.4. 시스템 구성도
2.  **시작하기**
    *   2.1. 시스템 요구 사양
    *   2.2. 하드웨어 연결 가이드
    *   2.3. 프로그램 실행 및 화면 구성
3.  **기본 사용법 (검사 작업자 가이드)**
    *   3.1. 튜토리얼: 첫 니들 검사하기
    *   3.2. 검사 유형별 차이점
    *   3.3. 카메라 화면 활용
4.  **고급 기능 (현장 관리자 가이드)**
    *   4.1. 관리자 패널 접근
    *   4.2. 데이터 파일 및 저장 경로 변경
5.  **문제 해결 (Troubleshooting)**
    *   5.1. 자주 묻는 질문 (FAQ)
    *   5.2. 오류 상황별 대처 방법
    *   5.3. 프로그램 강제 종료 및 재시작
6.  **부록**
    *   6.1. 용어 설명
    *   6.2. 디버깅 모드 (개발자용)
    *   6.3. 기술 지원 정보

---

## 1. 서문

### 1.1. 매뉴얼에 대하여

이 매뉴얼은 Needle Inspector 소프트웨어의 설치, 사용법, 문제 해결 등 전반적인 내용을 다룹니다. 사용자는 이 문서를 통해 프로그램의 모든 기능을 효과적으로 활용할 수 있습니다.

### 1.2. 제품 개요

Needle Inspector는 니들의 저항과 높이를 정밀하게 검사하고, 그 결과를 자동으로 기록 및 관리하기 위한 소프트웨어입니다.

### 1.3. 주요 기능 요약

*   **자동화된 검사 워크플로우**: `START` 버튼 하나로 저항 측정과 높이 측정 준비가 자동으로 진행됩니다.
*   **듀얼 모터 제어**: 니들 높이 측정용 모터와 저항 측정용 모터를 독립적으로 제어합니다.
*   **실시간 카메라 피드**: 2개의 카메라를 통해 니들의 상태를 실시간으로 확인하고, 기준선을 설정하여 니들 높이를 판정할 수 있습니다.
*   **EEPROM 데이터 연동**: 데이터를 니들의 EEPROM에 직접 기록합니다.
*   **결과 자동 저장**: 판정 즉시 검사 결과 이미지가 지정된 경로에 자동으로 저장됩니다.
*   **유연한 데이터 관리**: 관리자 패널에서 검사에 필요한 사용자, 니들 모델 등의 데이터를 CSV, XLSX, TXT 파일로 쉽게 업데이트할 수 있습니다.

### 1.4. 시스템 구성도

Needle Inspector 시스템은 다음과 같은 하드웨어와 소프트웨어로 구성됩니다.

*   **주 제어 장치 (PC)**: 사용자 인터페이스(UI)를 실행하고 카메라 영상을 처리합니다.
*   **보조 제어 장치 (라즈베리파이)**: 모터, 저항 측정기, EEPROM 등 정밀 제어가 필요한 하드웨어를 직접 제어합니다.
*   **하드웨어**:
    *   카메라 (2개): PC에 USB 연결
    *   니들 높이 측정 모터 (1개): 라즈베리파이에 USB 연결
    *   저항 측정 모터 (1개): 라즈베리파이에 USB 연결
    *   저항 측정기 (1개): 라즈베리파이에 USB 연결
    *   EEPROM 모듈 (1개): 라즈베리파이에 USB 연결
    *   물리 버튼 (3개 - START/STOP, PASS, NG): 라즈베리파이에 GPIO 연결
*   **소프트웨어**: React 기반의 프론트엔드와 Python 기반의 백엔드 서버가 WebSocket 통신을 통해 유기적으로 동작합니다.

---

## 2. 시작하기

### 2.1. 시스템 요구 사양

*   **운영체제**: Windows 10 이상
*   **CPU**: [권장 사양 입력]
*   **메모리**: [권장 사양 입력]

### 2.2. 하드웨어 연결 가이드

프로그램을 실행하기 전, 모든 하드웨어가 올바르게 연결되었는지 확인하세요.

1.  **PC 연결**:
    *   USB 카메라 2개를 PC의 USB 포트에 연결합니다.
2.  **라즈베리파이 연결**:
    *   모터 컨트롤러, 저항 측정기, EEPROM 모듈을 각각 라즈베리파이의 USB 포트에 연결합니다.

> 💡 **팁**: USB 포트 번호는 특정할 필요가 없습니다. 프로그램이 자동으로 포트를 감지하여 연결합니다.

### 2.3. 프로그램 실행 및 화면 구성

1.  **프로그램 실행**: 제공된 폴더에서 `Needle Inspector.exe` 파일을 찾아 실행합니다.
2.  **화면 구성**: 프로그램의 메인 화면은 다음과 같이 4개의 주요 패널로 구성됩니다.

*   [이미지: 전체 화면 스크린샷 및 각 패널 영역 표시]

    *   **(A) 카메라 화면**: 2개의 카메라 영상을 실시간으로 보여주는 영역입니다. 선을 그어 높이 측정 기준선으로 활용할 수 있습니다.
    *   **(B) 데이터 설정 패널**: 검사할 니들의 종류, 제조사, 날짜 등 EEPROM에 기록될 데이터를 설정하는 영역입니다.
    *   **(C) 판정 패널**: 자동 검사 완료 후 `PASS` 또는 `NG` 버튼을 눌러 최종 판정을 내리는 영역입니다.
    *   **(D) 모터 제어 및 저항값 패널**: 수동으로 모터를 조작하거나, 자동 검사 시 모터 상태와 측정된 저항값을 보여주는 영역입니다.

---

## 3. 기본 사용법 (검사 작업자 가이드)

이 섹션에서는 검사 작업자가 프로그램을 사용하여 니들을 검사하는 표준 절차를 설명합니다.

### 3.1. 튜토리얼: 첫 니들 검사하기

이 튜토리얼을 따라 니들 하나를 검사하는 전체 과정을 쉽게 익힐 수 있습니다.

#### 1단계: 로그인

프로그램을 실행하면 가장 먼저 로그인 화면이 나타납니다. 관리자에게 부여받은 아이디(이름)와 비밀번호를 입력하여 로그인하세요.

*   [이미지: 아이디와 비밀번호를 입력하는 로그인 화면]

> ⚠️ **주의**: "로그인 정보가 올바르지 않습니다." 라는 메시지가 나타나면 아이디 또는 비밀번호를 다시 확인해주세요.

#### 2단계: 검사 조건 설정

로그인 후 **(B) 데이터 설정 패널**에서 검사할 니들의 정보를 정확하게 선택합니다. 설정된 데이터 값으로 EEPROM 값이 기록됩니다.

1.  **MTR-2 / MTR-4 선택**: 검사할 니들의 주 모델을 선택합니다.
2.  **세부 타입 선택**: 주 모델에 맞는 국가와 세부 니들 타입을 콤보박스에서 선택합니다.
3.  **제조사/날짜 설정**: 필요시 EEPROM에 기록할 제조사 코드와 날짜를 설정합니다.

*   [이미지: 데이터 설정 패널에서 니들 타입을 선택하는 모습]

> 💡 **팁**: 검사할 니들과 설정 패널의 정보가 일치하는지 항상 확인하세요.

#### 3단계: 자동 검사 시작

검사할 니들을 장비에 장착한 후, 화면의 **`START`** 버튼 또는 장비의 물리 `START` 버튼을 누르세요.

*   [이미지: START 버튼 위치 강조]

버튼을 누르면 자동 검사가 시작됩니다.

1.  **저항 측정 (MULTI 타입 한정)**: 저항 측정용 모터가 자동으로 하강하여 니들의 저항을 측정합니다.
2.  **높이 측정 준비**: 저항 측정이 완료되면, 높이 측정을 위해 니들 모터가 자동으로 상승합니다.

> 💡 **팁**: 자동 검사가 진행되는 동안 **(D) 모터 제어 및 저항값 패널**에서 저항값을 모니터링할 수 있습니다.

#### 4단계: 수동 판정 (높이 검사)

자동 검사가 완료되면 작업자가 최종 판정을 내릴 차례입니다. **(A) 카메라 화면**에 나타난 니들의 끝 부분이 기준선에 맞는지 육안으로 확인하세요.

*   **MTR 4.0 MULTI 타입**: 저항값은 자동으로 판정됩니다. 작업자는 **높이**만 보고 판정합니다.
*   **그 외 타입**: 작업자가 **높이**만 보고 판정합니다.

*   [이미지: 카메라 화면에서 기준선과 니들 높이를 비교하는 모습]

#### 5단계: 결과 저장 및 다음 검사 준비

높이 판정이 끝나면 **(C) 판정 패널**에서 **`PASS`** 또는 **`NG`** 버튼을 눌러 최종 결과를 확정합니다.

*   [이미지: PASS, NG 버튼 강조]

버튼을 누르는 즉시, 현재 화면이 캡처되고 검사 데이터와 함께 지정된 경로에 자동으로 저장됩니다.

하나의 검사가 완료되었습니다. 장비에서 검사한 니들을 제거하고 새로운 니들을 장착한 후, **2단계부터** 과정을 반복하여 다음 검사를 진행하세요.

---

## 4. 고급 기능 (현장 관리자 가이드)

이 섹션에서는 현장 관리자가 사용할 수 있는 고급 기능에 대해 설명합니다. 이 기능을 통해 검사 환경을 설정하고 유지보수할 수 있습니다.

### 4.1. 관리자 패널 접근 방법

메인 화면의 **(C) 판정 패널** 상단에 있는 '판정' 텍스트를 마우스로 3초 이상 길게 누르면, 판정 패널이 **관리자 패널**로 전환됩니다.

*   [이미지: '판정' 텍스트를 길게 눌러 관리자 패널로 전환하는 모습]

### 4.2. 데이터 파일 및 저장 경로 변경

관리자 패널에서는 검사에 사용되는 데이터 파일을 변경하거나, 검사 결과가 저장되는 위치를 바꿀 수 있습니다.

*   **사용 시나리오**:
    *   새로운 니들 모델이 추가되었을 때
    *   작업자 목록이 변경되었을 때 (`users.csv` 등)
    *   검사 결과 저장 폴더를 변경하고 싶을 때

**절차**:

1.  **파일/폴더 선택**: 변경하려는 항목(예: `MTR-4 파일`) 옆의 `찾기` 버튼을 클릭하여 새로운 데이터 파일(CSV, XLSX, TXT) 또는 폴더를 선택합니다.
2.  **설정 적용**: 모든 변경사항을 선택한 후, 하단의 `적용하기` 버튼을 클릭합니다.
3.  **재시작**: 시스템이 자동으로 설정을 저장하고 재시작되며, 변경된 내용이 즉시 반영됩니다.

*   [이미지: 관리자 패널에서 파일과 폴더를 선택하고 '적용하기' 버튼을 누르는 모습]

> 🔒 **보안**: 관리자 기능은 시스템 전체에 영향을 미치므로, 권한이 있는 관리자만 사용해야 합니다.

---

## 5. 문제 해결 (Troubleshooting)

프로그램 사용 중 문제가 발생했을 때 이 섹션을 참고하여 해결할 수 있습니다.

### 5.1. 자주 묻는 질문 (FAQ)

**Q: 로그인이 안 돼요.**

> A: "로그인 정보가 올바르지 않습니다" 메시지가 표시되면, 아이디와 비밀번호를 다시 확인해주세요. 문제가 지속되면 관리자에게 문의하여 `users.csv` 파일에 본인의 정보가 올바르게 등록되어 있는지 확인하세요.

**Q: START 버튼을 눌러도 반응이 없어요.**

> A: 다음 두 가지를 순서대로 확인하세요.
> 1.  **모터 연결 상태**: 디버깅 패널에서 모터 연결 상태를 확인하세요. 모터의 현재위치가 업데이트 되고 있지 않으면 모터 연결에 실패한 것입니다.
> 2.  **니들팁 체결 상태**: 장비에 니들이 제대로 장착되었는지 확인하세요. 상태 패널 혹은 디버깅 패널에서 '니들팁 체결 여부'를 확인할 수도 있습니다.

**Q: 저항값이 이상하게 나오거나 `NaN`으로 표시돼요.**

> A: 저항 측정기(하드웨어)가 라즈베리파이에 제대로 연결되었는지 확인하세요. 연결이 끊어지면 비정상적인 값이 측정될 수 있습니다.

**Q: PASS/NG 버튼을 눌러도 캡처 이미지가 저장되지 않아요.**

> A: 카메라가 PC에 정상적으로 연결되어 있는지 확인하세요. 카메라 연결이 끊어지면 캡처 기능이 동작하지 않을 수 있습니다.

### 5.2. 오류 상황별 대처 방법

| 증상 | 예상 원인 | 해결 방법 |
| --- | --- | --- |
| **저항값 임계치 초과** | 니들 불량 또는 접촉 불량 | 검사가 자동으로 중단되고 `NG` 버튼만 활성화됩니다. 니들을 교체하고 다시 시도하세요. |
| **콤보박스 목록이 비어있음** | 데이터 파일(`mtr2.csv` 등)이 비어있거나 경로 오류 | 관리자 패널에서 올바른 데이터 파일을 다시 지정하고 적용하세요. |
| **프로그램이 멈춤(응답 없음)** | 일시적인 시스템 오류 또는 하드웨어 통신 문제 | 검사기 장비의 전원을 완전히 껐다가 다시 켠 후, 프로그램을 재시작하세요. |

### 5.3. 프로그램 강제 종료 및 재시작

만약 프로그램이 완전히 멈추어 조작이 불가능한 경우, 다음 절차에 따라 시스템을 재시작하세요.

1.  Windows 작업 관리자(`Ctrl+Shift+Esc`)를 열어 `Needle Inspector.exe` 프로세스를 종료합니다.
2.  검사기 장비의 전원을 껐다가 다시 켭니다.
3.  `Needle Inspector.exe`를 다시 실행합니다.

---

## 6. 부록

### 6.1. 용어 설명

*   **EEPROM (Electrically Erasable Programmable Read-Only Memory)**: 전원을 꺼도 데이터가 지워지지 않는 비휘발성 메모리의 한 종류입니다. 이 프로그램에서는 니들의 모델, 제조사, 생산 날짜 등의 정보를 기록하는 데 사용됩니다.
*   **GPIO (General-Purpose Input/Output)**: 다용도 입출력 포트로, 라즈베리파이와 같은 장치에서 버튼, 센서 등 외부 하드웨어와 신호를 주고받는 데 사용됩니다.
*   **MTR (Motor)**: ??? MTR은 무슨 뜻?

### 6.2. 디버깅 모드 (개발자용)

관리자 패널에서 `디버깅 모드 ON` 버튼을 클릭하면, 화면에 드래그 가능한 상태 정보창이 나타납니다. 이 창을 통해 개발자나 시스템 유지보수 담당자는 다음과 같은 실시간 정보를 확인할 수 있습니다.

*   **모터 현재 위치**: 각 모터의 실시간 위치 값
*   **GPIO 상태**: 니들팁 체결 여부, 쇼트 여부 등

*   [이미지: 디버깅 모드가 켜진 화면과 상태 정보창]

> 💡 **팁**: 일반 검사 작업자는 이 기능을 사용할 필요가 없습니다. 시스템에 이상이 있다고 의심될 때 문제 진단을 위해 사용하세요.

### 6.3. 기술 지원 정보

이 매뉴얼로 해결되지 않는 문제가 발생하거나 기술적인 지원이 필요한 경우, 아래 담당자에게 연락해주시기 바랍니다.

*   **회사**: SOLIS MSN
*   **담당**: 유주연
